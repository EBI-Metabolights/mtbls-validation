from metabolights_utils.models.isa.assay_file import AssayFile, AssayTechnique
from metabolights_utils.models.isa.common import (
    IsaTable,
    IsaTableColumn,
    ColumnsStructure,
)
from scripts.test_data.files.assignment_01 import assignment_file

assay_file = AssayFile(
    file_path="a_REQ2025111188888-01_MS_metabolite_profiling.txt",
    assay_technique=AssayTechnique(name="MS", main_technique="MS"),
    table=IsaTable(
        columns=[
            "Sample Name",
            "Protocol REF",
            "Parameter Value[Post Extraction]",
            "Parameter Value[Derivatization]",
            "Extract Name",
            "Label",
            "Term Source REF.1",
            "Term Accession Number.1",
            "Protocol REF.2",
            "Parameter Value[Scan polarity]",
            "Parameter Value[Scan m/z range]",
            "Parameter Value[Instrument]",
            "Term Source REF.2",
            "Term Accession Number.2",
            "Parameter Value[Ion source]",
            "Term Source REF.3",
            "Term Accession Number.3",
            "Parameter Value[Mass analyzer]",
            "Term Source REF.4",
            "Term Accession Number.4",
            "MS Assay Name",
            "Raw Spectral Data File",
            "Protocol REF.3",
            "Normalization Name",
            "Derived Spectral Data File",
            "Protocol REF.4",
            "Data Transformation Name",
            "Metabolite Assignment File",
        ],
        headers=[
            IsaTableColumn(
                column_index=0,
                column_header="database_identifier",
                column_name="database_identifier",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=1,
                column_header="chemical_formula",
                column_name="chemical_formula",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=2,
                column_header="smiles",
                column_name="smiles",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=3,
                column_header="inchi",
                column_name="inchi",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=4,
                column_header="metabolite_identification",
                column_name="metabolite_identification",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=5,
                column_header="mass_to_charge",
                column_name="mass_to_charge",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=6,
                column_header="fragmentation",
                column_name="fragmentation",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=7,
                column_header="modifications",
                column_name="modifications",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=8,
                column_header="charge",
                column_name="charge",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=9,
                column_header="retention_time",
                column_name="retention_time",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=10,
                column_header="taxid",
                column_name="taxid",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=11,
                column_header="species",
                column_name="species",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=12,
                column_header="database",
                column_name="database",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=13,
                column_header="database_version",
                column_name="database_version",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=14,
                column_header="reliability",
                column_name="reliability",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=15,
                column_header="uri",
                column_name="uri",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=16,
                column_header="search_engine",
                column_name="search_engine",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=17,
                column_header="search_engine_score",
                column_name="search_engine_score",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=18,
                column_header="smallmolecule_abundance_sub",
                column_name="smallmolecule_abundance_sub",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=19,
                column_header="smallmolecule_abundance_stdev_sub",
                column_name="smallmolecule_abundance_stdev_sub",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=20,
                column_header="smallmolecule_abundance_std_error_sub",
                column_name="smallmolecule_abundance_std_error_sub",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=21,
                column_header="Assay 1",
                column_name="Assay 1",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=22,
                column_header="Assay 2",
                column_name="Assay 2",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
            IsaTableColumn(
                column_index=23,
                column_header="Assay 3",
                column_name="Assay 3",
                column_structure=ColumnsStructure.SINGLE_COLUMN,
            ),
        ],
        data={
            "Sample Name": ["Sample 1", "Sample 2", "Sample 3"],
            "Protocol REF": ["Extraction", "Extraction", "Extraction"],
            "Parameter Value[Post Extraction]": [
                "MeOH/H2O (70:30, v:v)",
                "MeOH/H2O (70:30, v:v)",
                "MeOH/H2O (70:30, v:v)",
            ],
            "Parameter Value[Derivatization]": ["", "", ""],
            "Extract Name": ["Sample 1", "Sample 2", "Sample 3"],
            "Label": [
                "Label 1",
                "Label 2",
                "Label 3",
            ],
            "Term Source REF.1": ["", "", ""],
            "Term Accession Number.1": ["", "", ""],
            "Protocol REF.2": [
                "Mass spectrometry",
                "Mass spectrometry",
                "Mass spectrometry",
            ],
            "Parameter Value[Scan polarity]": [
                "alternating",
                "alternating",
                "alternating",
            ],
            "Parameter Value[Scan m/z range]": ["100-1000", "100-1000", "100-1000"],
            "Parameter Value[Instrument]": [
                "Thermo Scientific Q Exactive HF",
                "Thermo Scientific Q Exactive HF",
                "Thermo Scientific Q Exactive HF",
            ],
            "Term Source REF.2": ["MTBLS", "MTBLS", "MTBLS"],
            "Term Accession Number.2": [
                "http://www.ebi.ac.uk/metabolights/ontology/MTBLS_000660",
                "http://www.ebi.ac.uk/metabolights/ontology/MTBLS_000660",
                "http://www.ebi.ac.uk/metabolights/ontology/MTBLS_000660",
            ],
            "Parameter Value[Ion source]": [
                "electrospray ionization",
                "electrospray ionization",
                "electrospray ionization",
            ],
            "Term Source REF.3": ["MS", "MS", "MS"],
            "Term Accession Number.3": [
                "http://purl.obolibrary.org/obo/MS_1000073",
                "http://purl.obolibrary.org/obo/MS_1000073",
                "http://purl.obolibrary.org/obo/MS_1000073",
            ],
            "Parameter Value[Mass analyzer]": ["orbitrap", "orbitrap", "orbitrap"],
            "Term Source REF.4": ["MS", "MS", "MS"],
            "Term Accession Number.4": [
                "http://purl.obolibrary.org/obo/MS_1000484",
                "http://purl.obolibrary.org/obo/MS_1000484",
                "http://purl.obolibrary.org/obo/MS_1000484",
            ],
            "MS Assay Name": ["Assay 1", "Assay 2", "Assay 3"],
            "Raw Spectral Data File": [
                "FILES/raw1.raw",
                "FILES/raw2.raw",
                "FILES/raw3.raw",
            ],
            "Protocol REF.3": [
                "Data transformation",
                "Data transformation",
                "Data transformation",
            ],
            "Normalization Name": ["", "", ""],
            "Derived Spectral Data File": ["", "", ""],
            "Protocol REF.4": [
                "Metabolite identification",
                "Metabolite identification",
                "Metabolite identification",
            ],
            "Data Transformation Name": ["", "", ""],
            "Metabolite Assignment File": [
                assignment_file.file_path,
                assignment_file.file_path,
                assignment_file.file_path,
            ],
        },
    ),
)
